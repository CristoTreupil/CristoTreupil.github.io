---
import { ClientRouter } from "astro:transitions";
---


<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>So's Portfolio</title>
		<ClientRouter />
	</head>
	<header>
		<nav class="navbar">
			<div class="nav-container">
				<div class="nav-logo">
					<a href="/">So's Portfolio</a>
				</div>
				<div class="nav-menu">
					<ul class="nav-list">
						<li class="nav-item">
							<a href="/" class="nav-link">Inicio</a>
						</li>
						<li class="nav-item">
							<a href="/about" class="nav-link">Sobre Mí</a>
						</li>
						<li class="nav-item">
							<a href="/services" class="nav-link">Servicios</a>
						</li>
					</ul>
				</div>
				<div class="nav-toggle">
					<span class="bar"></span>
					<span class="bar"></span>
					<span class="bar"></span>
				</div>
			</div>
		</nav>
	</header>
	<body>
		<slot />
		
		<footer class="footer">
			<div class="footer-container">
				<div class="footer-content">
					<h2 class="footer-title">¿Trabajamos Juntos?</h2>
					<p class="footer-description">
						Si tienes un proyecto en mente o simplemente quieres conversar sobre ideas creativas, 
						no dudes en contactarme.
					</p>
					<div class="contact-info">
						<div class="email-section">
							<svg class="email-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="#e74c3c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<polyline points="22,6 12,13 2,6" stroke="#e74c3c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<a href="mailto:so.ilustradora@email.com" class="email-link">so.dibujitos@gmail.com</a>
						</div>
					</div>
					<div class="social-links">
						<a href="#" class="social-icon" aria-label="Instagram">
							<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
								<rect x="2" y="2" width="20" height="20" rx="5" ry="5" stroke="currentColor" stroke-width="2"/>
								<path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" stroke="currentColor" stroke-width="2"/>
								<line x1="17.5" y1="6.5" x2="17.51" y2="6.5" stroke="currentColor" stroke-width="2"/>
							</svg>
						</a>
						<a href="#" class="social-icon" aria-label="Behance">
							<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
								<circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/>
								<path d="M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-3.92 7.94" stroke="currentColor" stroke-width="2"/>
							</svg>
						</a>
						<a href="#" class="social-icon" aria-label="LinkedIn">
							<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
								<path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" stroke="currentColor" stroke-width="2"/>
								<rect x="2" y="9" width="4" height="12" stroke="currentColor" stroke-width="2"/>
								<circle cx="4" cy="4" r="2" stroke="currentColor" stroke-width="2"/>
							</svg>
						</a>
					</div>
				</div>
				<div class="footer-bottom">
					<p>&copy; 2025 So's Portfolio. Todos los derechos reservados.</p>
				</div>
			</div>
		</footer>
		
		<script>
			// Function to update active nav link
			function updateActiveNavLink() {
				const currentPath = window.location.pathname;
				const navLinks = document.querySelectorAll('.nav-link');
				
				console.log('Updating active nav link for path:', currentPath);
				
				navLinks.forEach(link => {
					if (link instanceof HTMLElement) {
						const linkHref = link.getAttribute('href');
						
						// Reset all links first
						link.style.color = '';
						link.style.fontWeight = '';
						
						// Check if this is the active link
						// For home (/), exact match. For others, starts with path
						if (linkHref) {
							const isActive = (linkHref === '/' && currentPath === '/') || 
							                 (linkHref !== '/' && currentPath.startsWith(linkHref));
							
							if (isActive) {
								link.style.color = '#e74c3c';
								link.style.fontWeight = 'bold';
								console.log('Active link:', linkHref);
							}
						}
					}
				});
			}

			// Function to setup mobile menu
			function setupMobileMenu() {
				const navToggle = document.querySelector('.nav-toggle');
				const navMenu = document.querySelector('.nav-menu');
				
				if (!navToggle || !navMenu) return;

				// Remove existing listeners by cloning
				const newNavToggle = navToggle.cloneNode(true) as HTMLElement;
				navToggle.parentNode?.replaceChild(newNavToggle, navToggle);

				// Add click listener to toggle
				newNavToggle.addEventListener('click', function() {
					if (newNavToggle instanceof HTMLElement) {
						newNavToggle.classList.toggle('active');
						navMenu.classList.toggle('active');
					}
				});

				// Close menu when clicking on a link
				const navLinks = document.querySelectorAll('.nav-link');
				navLinks.forEach(link => {
					link.addEventListener('click', function() {
						if (newNavToggle instanceof HTMLElement) {
							newNavToggle.classList.remove('active');
							navMenu.classList.remove('active');
						}
					});
				});

				// Close menu when clicking outside
				document.addEventListener('click', function(event) {
					const target = event.target;
					if (target && target instanceof Node) {
						const toggle = document.querySelector('.nav-toggle');
						const menu = document.querySelector('.nav-menu');
						if (toggle && menu && !toggle.contains(target) && !menu.contains(target)) {
							toggle.classList.remove('active');
							menu.classList.remove('active');
						}
					}
				});
			}

			// Initialize on first load
			document.addEventListener('DOMContentLoaded', function() {
				console.log('DOMContentLoaded - initializing navbar');
				setupMobileMenu();
				updateActiveNavLink();
			});

			// Update on View Transition navigation
			document.addEventListener('astro:page-load', function() {
				console.log('astro:page-load - updating navbar');
				setupMobileMenu();
				updateActiveNavLink();
			});

			// Also update after transition completes
			document.addEventListener('astro:after-swap', function() {
				console.log('astro:after-swap - updating navbar');
				updateActiveNavLink();
			});
		</script>
	</body>
</html>

<style>
	body {
		background-color: #fdf8e1;
		margin: 0;
		padding: 0;
		font-family: 'Arial', sans-serif;
	}

	/* Header Styles */
	.navbar {
		background-color: #fcefb4;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		position: fixed;
		top: 0;
		width: 100%;
		z-index: 1000;
		transition: all 0.3s ease;
	}

	.nav-container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 20px;
		display: flex;
		justify-content: space-between;
		align-items: center;
		background-color: #fcefb4;
		height: 70px;
	}

	.nav-logo a {
		font-size: 24px;
		font-weight: bold;
		color: #2c3e50;
		text-decoration: none;
		transition: color 0.3s ease;
	}

	.nav-logo a:hover {
		color: #e74c3c;
	}

	.nav-list {
		display: flex;
		list-style: none;
		margin: 0;
		padding: 0;
		gap: 30px;
	}

	.nav-link {
		color: #2c3e50;
		text-decoration: none;
		font-weight: 500;
		padding: 8px 16px;
		border-radius: 20px;
		transition: all 0.3s ease;
		position: relative;
	}

	.nav-link:hover {
		color: #e74c3c;
		background-color: #ebdda3;
		transform: translateY(-2px);
	}

	.nav-link::after {
		content: '';
		position: absolute;
		width: 0;
		height: 2px;
		bottom: 0;
		left: 50%;
		background-color: #e74c3c;
		transition: all 0.3s ease;
	}

	.nav-link:hover::after {
		width: 100%;
		left: 0;
	}

	/* Mobile Menu Toggle */
	.nav-toggle {
		display: none;
		flex-direction: column;
		cursor: pointer;
		padding: 5px;
	}

	.bar {
		width: 25px;
		height: 3px;
		background-color: #2c3e50;
		margin: 3px 0;
		transition: 0.3s;
		border-radius: 2px;
	}

	/* Body padding to account for fixed header */
	body {
		padding-top: 70px;
	}

	/* Responsive Design */
	@media screen and (max-width: 768px) {
		.nav-menu {
			position: fixed;
			left: -100%;
			top: 70px;
			flex-direction: column;
			background-color: #ffffff;
			width: 100%;
			text-align: center;
			transition: 0.3s;
			box-shadow: 0 10px 27px rgba(0, 0, 0, 0.05);
			height: calc(100vh - 70px);
			padding-top: 50px;
		}

		.nav-menu.active {
			left: 0;
		}

		.nav-list {
			flex-direction: column;
			gap: 20px;
		}

		.nav-item {
			margin: 15px 0;
		}

		.nav-link {
			font-size: 18px;
			padding: 15px 20px;
			display: block;
			border-radius: 0;
		}

		.nav-toggle {
			display: flex;
		}

		.nav-toggle.active .bar:nth-child(2) {
			opacity: 0;
		}

		.nav-toggle.active .bar:nth-child(1) {
			transform: translateY(8px) rotate(45deg);
		}

		.nav-toggle.active .bar:nth-child(3) {
			transform: translateY(-8px) rotate(-45deg);
		}
	}

	@media screen and (max-width: 480px) {
		.nav-container {
			padding: 0 15px;
		}

		.nav-logo a {
			font-size: 20px;
		}
	}

	/* Footer Styles */
	.footer {
		background-color: #fcefb4;
		padding: 60px 20px 30px;
		margin-top: 80px;
	}

	.footer-container {
		max-width: 1200px;
		margin: 0 auto;
	}

	.footer-content {
		text-align: center;
		margin-bottom: 40px;
	}

	.footer-title {
		font-size: 2.5rem;
		color: #2c3e50;
		margin-bottom: 15px;
		font-weight: bold;
	}

	.footer-description {
		font-size: 1.1rem;
		color: #7f8c8d;
		max-width: 600px;
		margin: 0 auto 30px;
		line-height: 1.6;
	}

	.contact-info {
		margin: 30px 0;
	}

	.email-section {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 15px;
		background: #ffffff;
		padding: 20px 30px;
		border-radius: 50px;
		max-width: fit-content;
		margin: 0 auto;
		box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
		transition: all 0.3s ease;
	}

	.email-section:hover {
		transform: translateY(-3px);
		box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
	}

	.email-icon {
		flex-shrink: 0;
	}

	.email-link {
		font-size: 1.2rem;
		color: #2c3e50;
		text-decoration: none;
		font-weight: 600;
		transition: color 0.3s ease;
	}

	.email-link:hover {
		color: #e74c3c;
	}

	.social-links {
		display: flex;
		justify-content: center;
		gap: 20px;
		margin-top: 30px;
	}

	.social-icon {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 50px;
		height: 50px;
		background: #ffffff;
		border-radius: 50%;
		color: #7f8c8d;
		text-decoration: none;
		transition: all 0.3s ease;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	}

	.social-icon:hover {
		color: #e74c3c;
		transform: translateY(-5px);
		box-shadow: 0 5px 20px rgba(231, 76, 60, 0.3);
	}

	.footer-bottom {
		text-align: center;
		padding-top: 30px;
		border-top: 2px solid #ebdda3;
	}

	.footer-bottom p {
		color: #7f8c8d;
		font-size: 0.9rem;
		margin: 0;
	}

	@media screen and (max-width: 768px) {
		.footer {
			padding: 40px 20px 20px;
			margin-top: 60px;
		}

		.footer-title {
			font-size: 2rem;
		}

		.footer-description {
			font-size: 1rem;
		}

		.email-section {
			flex-direction: column;
			padding: 20px;
			gap: 10px;
		}

		.email-link {
			font-size: 1rem;
			word-break: break-all;
		}

		.social-links {
			gap: 15px;
		}

		.social-icon {
			width: 45px;
			height: 45px;
		}
	}
</style>
